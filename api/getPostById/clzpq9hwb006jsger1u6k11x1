{"type":"getPostById","data":{"title":"【数字信号处理】Matlab做fft时点数N怎么选取","date":"2022-03-30T13:35:26.000Z","description":"","categories":[{"name":"数字信号处理","_id":"clzpq9hwf006qsgerfora37z9"}],"tags":[{"name":"Matlab","_id":"clzpq9hze00blsgerb8t8dif7"}],"content":"<p>转载自 <a href=\"https://blog.csdn.net/baidu_37973494/article/details/81076343\">https://blog.csdn.net/baidu_37973494/article/details/81076343</a></p>\n<p>(作为笔记，防止遗忘)</p>\n<p>一、FFT点数N（也就是离散时间信号的记录长度）：要根据所要求的的频率分辨率F来决定。</p>\n<p>频率分辨率F：能够用FFT算法分析得到的最靠近的两个信号频率之间的间隔。</p>\n<p>N和F的关系：N&gt;=Fs/F, Fs为采样频率。由于FFT一般要求N是2的整数幂，所以最后还要把N扩大为最接近2的整数幂。</p>\n<p>二、参考网页如何决定要使用多少点来做fft：<a href=\"https://zhidao.baidu.com/question/1111808097700853939.html%EF%BC%88%E9%87%8D%E7%82%B9%EF%BC%89\">https://zhidao.baidu.com/question/1111808097700853939.html（重点）</a></p>\n<p>fft函数出来的应该是个复数，每一个点分实部虚部两部分。假设采用1024点fft，采样频率是fs，那么第一个点对应0频率点，第512点对应的就是fs/2的频率点。然后从头开始找模值最大的那个点，其所对应的频率值应该就是你要的基波频率了。</p>\n<p>假设采样频率为Fs，信号频率F，采样点数为N。那么FFT之后结果就是一个为N点的复数。每一个点就对应着一个频率点。这个点的模值，就是该频率值下的幅度特性。具体跟原始信号的幅度有什么关系呢？假设原始信号的峰值为A，那么FFT的结果的每个点（除了第一个点直流分量之外）的模值就是A的N/2倍。而第一个点就是直流分量，它的模值就是直流分量的N倍。</p>\n<figure class=\"highlight m\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">%-----------------------------------------------%</span></span><br><span class=\"line\"><span class=\"comment\">%Author             :  aoxiang_ywj</span></span><br><span class=\"line\"><span class=\"comment\">%Project            :  Matlab做fft时点数N怎么选取</span></span><br><span class=\"line\"><span class=\"comment\">%Brief introduction :</span></span><br><span class=\"line\"><span class=\"comment\">%假设我们有一个信号，它含有2V的直流分量，频率为50Hz、相位为-30度、幅度为3V的交流信号，以及一个频率为75Hz、相位为90度、幅度为1.5V的交流信号。</span></span><br><span class=\"line\"><span class=\"comment\">%用数学表达式就是如下： S=2+3*cos(2*pi*50*t-pi*30/180)+1.5*cos(2*pi*75*t+pi*90/180)  </span></span><br><span class=\"line\"><span class=\"comment\">%式中cos参数为弧度，所以-30度和90度要分别换算成弧度。我们以256Hz的采样率对这个信号进行采样，总共采样256点。</span></span><br><span class=\"line\"><span class=\"comment\">%按照我们上面的分析，Fn=(n-1)*Fs/N，我们可以知道，每两个点之间的间距就是1Hz，第n个点的频率就是n-1。</span></span><br><span class=\"line\"><span class=\"comment\">%我们的信号有3个频率：0Hz、50Hz、75Hz，应该分别在第1个点、第51个点、第76个点上出现峰值，其它各点应该接近0。实际情况如何呢？ 看figure（2）</span></span><br><span class=\"line\"><span class=\"comment\">%-----------------------------------------------%</span></span><br><span class=\"line\">clc;</span><br><span class=\"line\">clear;</span><br><span class=\"line\">close <span class=\"built_in\">all</span>; <span class=\"comment\">%先关闭所有图片</span></span><br><span class=\"line\">Adc<span class=\"built_in\">=</span><span class=\"number\">2</span>;  <span class=\"comment\">%直流分量幅度</span></span><br><span class=\"line\">A1<span class=\"built_in\">=</span><span class=\"number\">3</span>;   <span class=\"comment\">%频率F1信号的幅度</span></span><br><span class=\"line\">A2<span class=\"built_in\">=</span><span class=\"number\">1.5</span>; <span class=\"comment\">%频率F2信号的幅度</span></span><br><span class=\"line\">F1<span class=\"built_in\">=</span><span class=\"number\">50</span>;  <span class=\"comment\">%信号1频率(Hz)</span></span><br><span class=\"line\">F2<span class=\"built_in\">=</span><span class=\"number\">75</span>;  <span class=\"comment\">%信号2频率(Hz)</span></span><br><span class=\"line\">Fs<span class=\"built_in\">=</span><span class=\"number\">256</span>; <span class=\"comment\">%采样频率(Hz)</span></span><br><span class=\"line\">P1<span class=\"built_in\">=</span>-<span class=\"number\">30</span>; <span class=\"comment\">%信号1相位(度)</span></span><br><span class=\"line\">P2<span class=\"built_in\">=</span><span class=\"number\">90</span>;  <span class=\"comment\">%信号相位(度)</span></span><br><span class=\"line\">N<span class=\"built_in\">=</span><span class=\"number\">256</span>;  <span class=\"comment\">%采样点数</span></span><br><span class=\"line\">t<span class=\"built_in\">=</span>[<span class=\"number\">0</span>:<span class=\"number\">1</span>/Fs:N/Fs]; <span class=\"comment\">%采样时刻</span></span><br><span class=\"line\"><span class=\"comment\">%Fn=(1:1:N)*Fs/N; %频域点数</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">%信号</span></span><br><span class=\"line\">S<span class=\"built_in\">=</span>Adc+A1*cos(<span class=\"number\">2</span>*pi*F1*t+pi*P1/<span class=\"number\">180</span>)+A2*cos(<span class=\"number\">2</span>*pi*F2*t+pi*P2/<span class=\"number\">180</span>);</span><br><span class=\"line\"><span class=\"comment\">%显示原始信号</span></span><br><span class=\"line\">plot(S);</span><br><span class=\"line\">title(<span class=\"string\">&#x27;原始信号&#x27;</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">figure;</span><br><span class=\"line\">Y <span class=\"built_in\">=</span> fft(S,N); <span class=\"comment\">%做FFT变换</span></span><br><span class=\"line\">Ayy <span class=\"built_in\">=</span> (abs(Y)); <span class=\"comment\">%取模</span></span><br><span class=\"line\">plot(Ayy(<span class=\"number\">1</span>:N));   <span class=\"comment\">%显示原始的FFT模值结果          与plot(Ayy);效果一样</span></span><br><span class=\"line\"><span class=\"comment\">%plot(Fn,Ayy(1:N));</span></span><br><span class=\"line\">title(<span class=\"string\">&#x27;FFT 模值&#x27;</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">figure;</span><br><span class=\"line\">Ayy<span class=\"built_in\">=</span>Ayy/(N/<span class=\"number\">2</span>);   <span class=\"comment\">%换算成实际的幅度</span></span><br><span class=\"line\">Ayy(<span class=\"number\">1</span>)<span class=\"built_in\">=</span>Ayy(<span class=\"number\">1</span>)/<span class=\"number\">2</span>;</span><br><span class=\"line\">F<span class=\"built_in\">=</span>([<span class=\"number\">1</span>:N]-<span class=\"number\">1</span>)*Fs/N; <span class=\"comment\">%换算成实际的频率值</span></span><br><span class=\"line\">plot(F(<span class=\"number\">1</span>:N/<span class=\"number\">2</span>),Ayy(<span class=\"number\">1</span>:N/<span class=\"number\">2</span>));   <span class=\"comment\">%显示换算后的FFT模值结果</span></span><br><span class=\"line\">title(<span class=\"string\">&#x27;幅度-频率曲线图&#x27;</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">figure;</span><br><span class=\"line\">Pyy<span class=\"built_in\">=</span>[<span class=\"number\">1</span>:N/<span class=\"number\">2</span>];</span><br><span class=\"line\">for i<span class=\"built_in\">=</span><span class=\"number\">1</span>:N/<span class=\"number\">2</span></span><br><span class=\"line\">    Pyy(i)<span class=\"built_in\">=</span>phase(Y(i)); <span class=\"comment\">%计算相位</span></span><br><span class=\"line\">    Pyy(i)<span class=\"built_in\">=</span>Pyy(i)*<span class=\"number\">180</span>/pi; <span class=\"comment\">%换算为角度</span></span><br><span class=\"line\">end;</span><br><span class=\"line\">plot(F(<span class=\"number\">1</span>:N/<span class=\"number\">2</span>),Pyy(<span class=\"number\">1</span>:N/<span class=\"number\">2</span>));   <span class=\"comment\">%显示相位图</span></span><br><span class=\"line\">title(<span class=\"string\">&#x27;相位-频率曲线图&#x27;</span>);</span><br></pre></td></tr></table></figure>","_path":"20220330/shu-zi-xin-hao-chu-li-matlab-zuo-fft-shi-dian-shu-n-zen-me-xuan-qu/","_link":"https://yaoqs.github.io/20220330/shu-zi-xin-hao-chu-li-matlab-zuo-fft-shi-dian-shu-n-zen-me-xuan-qu/","_id":"clzpq9hwb006jsger1u6k11x1"}}