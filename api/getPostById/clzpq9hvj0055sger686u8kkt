{"type":"getPostById","data":{"title":"js函数中如何使用可选参数（包括可选回调函数）","date":"2022-06-15T03:01:11.000Z","description":"","categories":[{"name":"技术笔记","_id":"clzpq9ht6001lsger8yzb9r3x"},{"name":"js","_id":"clzpq9hvn005dsger7lqu8fr8"}],"tags":[{"name":"js","_id":"clzpq9htp002isger04obauv9"}],"content":"<p>转载自<a href=\"https://www.javascriptc.com/interview-tips/zh_cn/javascript/use-optional-arguments/\">函数中如何使用可选参数（包括可选回调函数） - 每天一个JavaScript小知识@Js中文网 · 码农进阶题库</a></p>\n<p>实例函数中第2个与第3个参数为可选参数</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">example</span>(<span class=\"params\"> err, optionalA, optionalB, callback </span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 使用数组取出arguments</span></span><br><span class=\"line\">    <span class=\"keyword\">var</span> args = <span class=\"keyword\">new</span> <span class=\"title class_\">Array</span>(<span class=\"variable language_\">arguments</span>.<span class=\"property\">length</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; args.<span class=\"property\">length</span>; ++i) &#123;</span><br><span class=\"line\">        args[i] = <span class=\"variable language_\">arguments</span>[i];</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 第一个参数为错误参数</span></span><br><span class=\"line\">    <span class=\"comment\">// shift() 移除数组中第一个参数并将其返回</span></span><br><span class=\"line\">    err = args.<span class=\"title function_\">shift</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果最后一个参数是函数，则它为回调函数</span></span><br><span class=\"line\">    <span class=\"comment\">// pop() 移除数组中最后一个参数并将其返回</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> args[args.<span class=\"property\">length</span>-<span class=\"number\">1</span>] === <span class=\"string\">&#x27;function&#x27;</span>) &#123;</span><br><span class=\"line\">        callback = args.<span class=\"title function_\">pop</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果args中仍有元素，那就是你需要的可选参数</span></span><br><span class=\"line\">    <span class=\"comment\">// 你可以像这样一个一个的将其取出：</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (args.<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>) optionalA = args.<span class=\"title function_\">shift</span>(); <span class=\"keyword\">else</span> optionalA = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (args.<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>) optionalB = args.<span class=\"title function_\">shift</span>(); <span class=\"keyword\">else</span> optionalB = <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 像正常一样继续：检查是否有错误</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> callback &amp;&amp; <span class=\"title function_\">callback</span>(err);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 为了教程目的，打印可选参数</span></span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;optionalA:&#x27;</span>, optionalA);</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;optionalB:&#x27;</span>, optionalB);</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;callback:&#x27;</span>, callback);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/* 你想做的逻辑 */</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ES6语法书写更简短</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">example</span>(<span class=\"params\">...args</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 第一个参数为错误参数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> err = args.<span class=\"title function_\">shift</span>();</span><br><span class=\"line\">    <span class=\"comment\">// 如果最后一个参数是函数，则它为回调函数</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> callback = (<span class=\"keyword\">typeof</span> args[args.<span class=\"property\">length</span>-<span class=\"number\">1</span>] === <span class=\"string\">&#x27;function&#x27;</span>) ? args.<span class=\"title function_\">pop</span>() : <span class=\"literal\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果args中仍有元素，那就是你需要的可选参数你可以像这样一个一个的将其取出：</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> optionalA = (args.<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>) ? args.<span class=\"title function_\">shift</span>() : <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> optionalB = (args.<span class=\"property\">length</span> &gt; <span class=\"number\">0</span>) ? args.<span class=\"title function_\">shift</span>() : <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// ... 重复取更多参数</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err &amp;&amp; callback) <span class=\"keyword\">return</span> <span class=\"title function_\">callback</span>(err);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/* 你想做的逻辑 */</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 使用或不适用可选参数调用实例函数</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">example</span>(<span class=\"literal\">null</span>, <span class=\"string\">&#x27;AA&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">example</span>(<span class=\"literal\">null</span>, <span class=\"keyword\">function</span> (<span class=\"params\">err</span>) &#123;   <span class=\"comment\">/* do something */</span>    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">example</span>(<span class=\"literal\">null</span>, <span class=\"string\">&#x27;AA&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\">err</span>) &#123;&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">example</span>(<span class=\"literal\">null</span>, <span class=\"string\">&#x27;AAAA&#x27;</span>, <span class=\"string\">&#x27;BBBB&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\">err</span>) &#123;&#125;);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"如何保证optionalA和optionalB是预期的值\"><a class=\"header-anchor\" href=\"#如何保证optionalA和optionalB是预期的值\">※</a>如何保证optionalA和optionalB是预期的值?</h3>\n<p>设计你的函数，使其在接收optionalB时optionalA为必选参数。</p>\n<h4 id=\"扩展阅读\"><a class=\"header-anchor\" href=\"#扩展阅读\">※</a>扩展阅读</h4>\n<ul>\n<li><a href=\"https://www.jianshu.com/p/55fc2be7e0f0\">关于JS的可选参数，该知道的都在这里了.</a></li>\n<li><a href=\"https://www.javascriptc.com/1820.html\">前端面试必备——eslint篇</a></li>\n<li><a href=\"https://www.infoq.cn/article/es6-in-depth-rest-parameters-and-defaults\">深入浅出 ES6：不定参数和默认参数</a></li>\n<li><a href=\"https://www.javascriptc.com/category/frontend/es6-series\">ES6进阶深耕系列</a></li>\n</ul>\n","_path":"20220615/js-han-shu-zhong-ru-he-shi-yong-ke-xuan-can-shu-bao-gua-ke-xuan-hui-diao-han-shu/","_link":"https://yaoqs.github.io/20220615/js-han-shu-zhong-ru-he-shi-yong-ke-xuan-can-shu-bao-gua-ke-xuan-hui-diao-han-shu/","_id":"clzpq9hvj0055sger686u8kkt"}}